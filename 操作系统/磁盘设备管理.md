# 磁盘设备管理

- [磁盘结构](#磁盘结构)
- [磁盘调度算法](#磁盘调度算法)

---

## 磁盘结构

- 盘面（Platter）：一个磁盘有多个盘面；
- 磁道（Track）：盘面上的圆形带状区域，一个盘面可以有多个磁道；
- 扇区（Track Sector）：磁道上的一个弧段，一个磁道可以有多个扇区，它是最小的物理储存单位，目前主要有 512 bytes 与 4 K 两种大小；
- 磁头（Head）：与盘面非常接近，能够将盘面上的磁场转换为电信号（读），或者将电信号转换为盘面的磁场（写）；
- 制动手臂（Actuator arm）：用于在磁道之间移动磁头；
- 主轴（Spindle）：使整个盘面转动。

## 磁盘调度算法

读写一个磁盘块的时间的影响因素有：

- 旋转时间（主轴转动盘面，使得磁头移动到适当的扇区上）
- 寻道时间（制动手臂移动，使得磁头移动到适当的磁道上）
- 实际的数据传输时间

其中，寻道时间最长，因此磁盘调度的主要目标是使磁盘的平均寻道时间最短。

### 1. 先来先服务 FCFS, First Come First Served

- 按照磁盘访问请求到达的先后请求的顺序进行调度。
- 优点：公平和简单。
- 缺点：未对寻道做任何优化，使平均寻道时间可能较长，效率不高
- 相临两次请求可能会造成最内到最外柱面寻道，使磁头反复移动，增加了服务时间，对机器不利。

### 2. 最短寻道时间优先 SSTF, Shortest Seek Time First

- 优先调度与当前磁头所在磁道距离最近的磁道，主要考虑寻道优先。
- 平均寻道时间比较低，但是不够公平。
- 如果新到达的磁道请求总是比一个在等待的磁道请求近，那么在等待的磁道请求会一直等待下去，也就是出现饥饿现象。两端的磁道请求更容易出现饥饿现象。
- 优先选择距当前磁头最近的访问请求进行服务改善了磁盘平均服务时间，但是造成某些访问请求长期等待得不到服务。

### 3. 电梯算法 扫描算法（SCAN）

- 当设备无访问请求时，磁头不动；
- 当有访问请求时，磁头按一个方向移动，在移动过程中对遇到的访问请求进行服务，然后判断该方向上是否还有访问请求，如果有则继续.
- 电梯总是保持一个方向运行，直到该方向没有请求为止，然后改变运行方向。
- 因为考虑了移动方向，因此所有的磁盘请求都会被满足，解决了 SSTF 的饥饿问题。

### 4.循环扫描算法（CSCAN）

- 循环扫描调度算法是在扫描算法的基础上改进的。
- 磁臂改为单项移动，由外向里。当前位置开始沿磁臂的移动方向去选择离当前磁臂最近的哪个柱面的访问者。
- 如果沿磁臂的方向无请求访问时，再回到最外，访问柱面号最小的作业请求。